ShiftTime - タイムスタンプ調整ツール
 Version 1.0   (freeware)


 (C) 2002 INOUE. Hirokazu
 inoue-h@iname.com



【はじめに】
このプログラムは、複数のファイルのタイムスタンプ（時間）を一括して『一定時間
ずらす』設定を行うツールです
当初の目的は、時差のある海外で撮影した「デジカメの画像ファイル」のタイムスタ
ンプを現地時刻に設定しなおすため作成しています

UNIX のスクリプト使い以外の方向けです :-)


【動作環境】
Windows 95/98/Me, Windows NT/200/XP 日本語版
  MFC ver 4.2 のライブラリがインストールされていること (mfc42.dll, msvcrt.d
ll)


【インストール】
この画面を見ているということは、すでにインストール完了です


【アンインストール】
このプログラムは、レジストリおよび設定ファイルなどを利用しません
プログラム本体を消去すればそれで終わりです


【利用法】
「対象フォルダ」
   末尾に「￥」記号がつく形で指定すること。

「対象ファイル」
   ワイルドカード（*.JPG 等)を指定可能

※フォルダ + 検索後のファイル名 で 256 文字を越えない範囲

「時間調整」
   1か月=30日、1年=365日で換算している

設定項目を適宜設定したら、処理開始ボタンを押す


【例】
D:\My Documents\Photo フォルダの D0001.JPG, D0002.JPG, ... D0999.JPG
のタイムスタンプを 9時間戻したい
  （たとえば、2002/01/01 12:00 -> 2002/01/01 03:00）

● 対象フォルダは 「D:\My Documents\Photo\」 ← 最後の \ 記号は重要
● 対象ファイルは 「*.jpg」
● 時間調整は 「9時間」と「前にずらす」を選択する
(「-9時間」と「後ろにずらす」でも同じ処理になる。）


【制限事項】
「読み取り属性」のファイルは処理できない
ファイル以外のものは対象外（フォルダ等）

日時は UNIX 時間の範囲（およそ1970年〜2032年）しか設定できない
Windowsの拡張タイムスタンプのうち「作成日」、「最終更新日」のみ設定できます

パス名・ファイル名に利用できる文字は、通常 ANSI のアルファベットを想定。（長
いファイル名含む）
日本語の文字を使っている場合、エラーが出るかもしれません。（0x5cでエラーが出
ないことは確認していますが、全ての文字コードで確認はしていません）
安全に利用していただくためには、DOSの8+3形式のパス・ファイル名で、LFNを使わ
ないアルファベットのみと言うのが最も安全です
当方にエラーレポートを送っていただく前に、8+3形式アルファベットを試してみて
ください

これはフリーウエアです。あらゆる状況に対してのテストは行っていません。利用者
の良識ある利用をお願いします


【テクノロジ】
ソースコードの質問をする前に、下記を読んでみてください

このプログラムは、対象ファイルに対し次の操作をしているだけです
CFile::GetStatus(szTmp2, Fstatus);              // 属性を取得し
Fstatus.m_mtime += tmShift;                     // 時差を代入して計算
Fstatus.m_ctime += tmShift;                     // 時差を代入して計算
CFile::SetStatus(szTmp2, Fstatus);              // 属性を書き込む

書き込みでは、例外処理 try - catch 処理をしています
なお、時差の表現は
CTimeSpan tmShift(nYear*365 + nMonth*30 + nDay, nHour, nMin, nSec);


【使用許諾条件】
このプログラムとドキュメントをフリーウエアーとし、すべての著作権は作者である
井上博計に属します。
著作者はこのプログラム及びドキュメントに関するいかなる保証も行いません。この
プログラムの使用はすべて使用者の責任において行って下さい。
本製品の動作（正常動作、異常動作）によって被るすべての結果についての全責任は、
本ソフトの使用者にあります。
著作者による許可無しにこのプログラムとドキュメントを販売することは出来ません。
ただし、無料ソフトとして配布する場合はディスク料金や郵送料等、最低限の対価の
授受を伴ってもかまいません。また、雑誌などの販促物に付属させるときもこれに準
じます。
このプログラムのサポートは著作者宛電子メールを使用して行いますが、著作者がサ
ポートを行うのはボランティアであって義務・責務ではありません。
ネットワークを長期間留守にすることもありますので、自動的にメールが消去されて
いる可能性もありますのでご注意下さい。


「フリーウエアー、シェアウエアー」の記事として取り上げる場合や、同様の目的で
書籍等の付属CD-ROMに収録することを、（作者からお断りの連絡をしない限り）許可
します。
雑誌、書籍に掲載する場合は、作者までご一報ください（下記のすべてのアドレスに
対して）。なお、長期間留守にしている場合もありますので、掲載の許諾の返事が（
1週間以内に）無い場合は「許可した」ものとして扱えます。この場合見本誌は（作
者の住所が判明しない場合）、「大阪中央郵便局止め 井上博計宛」でお願いします。


雑誌、CD-ROM等メディアへの収録の許諾は、作者が最後の許諾通知を行ってから １
年間 とします。この期間を超えた後に掲載を行う場合は、再度許諾を取らなければ
なりません。
掲載メディア１種類（雑誌なら１号分、販促配布分なら１週間以内に連続してプレス
した１回分）につき、１件の許諾が必要です。
ただし、すでに製造が終わった「在庫品」の出荷および流通過程にある製品を除きま
す。


【ユーザー・サポート連絡先】
電子メール
  inoue-h@iname.com
ホームページ
  http://inoue-h.connect.to/
  http://www.vector.co.jp/authors/VA001911/freeware/index.html
  http://www.ne.jp/asahi/oasis/inoue-h/index.html

上記のアドレスが消滅している場合、検索エンジンで「井上博計」で検索してくださ
い。
My Journey - 旅のページ が私のページです
